system:
  api_host: 0.0.0.0
  api_port: 8000
  db_url: postgresql://admin:123456@localhost:5432/network_flow_db
  db_batch_size: 1000
  training_batch_size: 1000
  ingest_progress_every: 5000
  inference_progress_every: 10000
  inference_filter_enabled: true
  inference_filter_exclude_dns: true
  inference_filter_min_total_bytes: 20
  inference_filter_min_duration_ms: 0
  inference_filter_require_bidirectional: false
  inference_filter_block_ports:
  - 137
  - 138
  - 139
  - 1900
  - 5353
  - 67
  - 68
  - 123
  - 547   # DHCPv6 (本次 Top 1 噪音)
  - 5355  # LLMNR (本次 Top 2 噪音)
  nfstream_idle_timeout: 64
  nfstream_active_timeout: 120
  inference_store_results: false
  inference_use_db: false
  anomaly_score_mode: mahalanobis
  threshold_mahalanobis: 10
  training_data_dir: data/training
  offline_pcap_path: data/pcaps/infer/Thursday-cic.pcap
  offline_checkpoint_path: data/checkpoints/20260104_183832/checkpoints/best.pth
  offline_reference_stats_path: data/stats/reference_stats_cicids2017.pt
  offline_benign_stats_path: null
  offline_top_k: 10
  offline_output_dir: data/outputs
  offline_output_format: csv
  offline_output_only_anomalies: false
  api_output_dir: data/outputs/api
  api_save_output: true
  api_output_only_anomalies: false
  api_top_k: 30
  checkpoints_dir: data/checkpoints
  stats_dir: data/stats
model:
  dataset_name: cicids2017
  latent_dim: 64
  training_mode: correlated
  n_components: 5
  hidden_dim: 256
  dropout_rate: 0.2
  vocab_size: 257
  emb_dim: 128
  packet_latent_dim: 256
  session_d_model: 256
  header_tcn_channels:
  - 256
  - 192
  - 128
  payload_tcn_channels:
  - 256
  - 192
  - 128
  header_strides:
  - 2
  - 1
  - 1
  payload_strides:
  - 2
  - 1
  - 1
  tcn_kernel_size: 3
  tcn_dropout: 0.1
  tcn_use_se: true
  tcn_causal: true
  cross_attn_heads: 4
  cross_attn_dropout: 0.1
  spatial_reduction_size: 8
  num_packets: 8
  packet_len: 64
  header_only: true
  use_dilation: true
  depthwise_only: false
  global_fuse: concat
  global_mlp_hidden: 64
  global_mlp_out: 32
  session_tcn_channels:
  - 192
  - 128
  - 64
  session_tcn_causal: true
  session_aggregator: mean
  decoder_rank: 256
  decoder_num_layers: 1
  bytes_pkts: 8
  bytes_len: 64
  seq_len: 50
  use_global_stats: true
  global_stats_keys:
  - duration_ms
  - total_packets
  - total_bytes
  - mean_ps
  - std_ps
  - min_ps
  - max_ps
  - iat_mean
  - iat_std
  - syn_count
  - rst_count
  - psh_count
  - fin_count
  - window_mean
  - packets_per_sec
  - bytes_per_sec
  - is_tcp
  - is_udp
  - packet_ratio
  - byte_ratio
  - src2dst_bytes
  - dst2src_bytes
  threshold_zscore: 3.0
training:
  train_data_path: C:/Users/zyf17/Desktop/projects/data/training/training_data.npz
  device: auto
  output_dir: data/checkpoints
  batch_size: 256
  num_epochs: 50
  lr: 1e-5
  weight_decay: 1e-5
  kld_weight: 1.0
  correlation_penalty_weight: 0.05
  use_kl_annealing: true
  kld_weight_min: 0.1
  kld_weight_max: 0.5
  kl_anneal_period: 10
  kld_warmup_epochs: 5
  free_bits: 0.0
  capacity: 40.0
  capacity_weight: 1.0
  cov_offdiag_weight: 1e-4
  ortho_weight: 1e-4
  val_split: 0.1
  num_workers: 0
  seed: 42
  log_interval: 50
  save_interval: 5
  normalize_bytes: false
  use_global_stats: true
  limit: null
  use_scheduler: false
  scheduler_patience: 2
  scheduler_factor: 0.5
  min_lr: 1e-6
  use_early_stopping: true
  early_stopping_patience: 5
  early_stopping_min_delta: 1e-6
  compute_reference_stats: true
  reference_stats_path: null
